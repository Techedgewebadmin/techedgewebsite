---
import Button from "@/components/ui/buttons/Button.astro";

// ============================================================================
// DEMO CONTACT FORM - FOR PORTFOLIO/SHOWCASE PURPOSES ONLY
// ============================================================================
// This is a simplified demo version of the contact form that doesn't require
// environment variables or backend setup. It just shows a success message.
//
// üö® TO ENABLE PRODUCTION CONTACT FORM:
// 1. Rename this file to ContactFormDemo.astro
// 2. Rename ContactForm.PRODUCTION.astro to ContactForm.astro
// 3. Set up your environment variables (.env file):
//    - RESEND_API_KEY
//    - RESEND_EMAIL
//    - FROM_EMAIL
//    - UPSTASH_REDIS_REST_URL
//    - UPSTASH_REDIS_REST_TOKEN
// 4. See README.md for complete setup instructions
// ============================================================================
---

<form class="space-y-6" id="contact-form">
  <!-- Success Message -->
  <div id="form-message" class="hidden"></div>

  <!-- Demo Notice -->
  <div class="p-3 bg-amber-50 border border-amber-300 rounded-lg text-amber-800 text-sm">
    <p><strong>‚ö†Ô∏è Demo Mode:</strong> This form is for demonstration only. No emails will be sent.</p>
  </div>

  <!-- Name Fields in Grid -->
  <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
    <div class="space-y-2">
      <label
        for="first-name"
        class="text-sm md:text-base font-grotesk font-medium uppercase text-muted"
      >
        First Name *
      </label>
      <input
        type="text"
        id="first-name"
        name="name"
        required
        placeholder="First Name"
        class="w-full px-4 py-3 bg-transparent border-b-2 border-muted focus:border-secondary outline-none transition-colors duration-300 placeholder:text-muted/50"
      />
    </div>

    <div class="space-y-2">
      <label
        for="last-name"
        class="text-sm md:text-base font-grotesk font-medium uppercase text-muted"
      >
        Last Name *
      </label>
      <input
        type="text"
        id="last-name"
        name="lastname"
        required
        placeholder="Last Name"
        class="w-full px-4 py-3 bg-transparent border-b-2 border-muted focus:border-secondary outline-none transition-colors duration-300 placeholder:text-muted/50"
      />
    </div>
  </div>

  <!-- Email -->
  <div class="space-y-2">
    <label
      for="email"
      class="text-sm md:text-base font-grotesk font-medium uppercase text-muted"
    >
      Email *
    </label>
    <input
      type="email"
      id="email"
      name="email"
      required
      placeholder="example@email.com"
      class="w-full px-4 py-3 bg-transparent border-b-2 border-muted focus:border-secondary outline-none transition-colors duration-300 placeholder:text-muted/50"
    />
  </div>

  <!-- Subject -->
  <div class="space-y-2">
    <label
      for="subject"
      class="text-sm md:text-base font-grotesk font-medium uppercase text-muted"
    >
      Subject *
    </label>
    <input
      type="text"
      id="subject"
      name="subject"
      required
      placeholder="How can we help?"
      class="w-full px-4 py-3 bg-transparent border-b-2 border-muted focus:border-secondary outline-none transition-colors duration-300 placeholder:text-muted/50"
    />
  </div>

  <!-- Message -->
  <div class="space-y-2">
    <label
      for="message"
      class="text-sm md:text-base font-grotesk font-medium uppercase text-muted"
    >
      Project description *
    </label>
    <textarea
      id="message"
      name="message"
      rows="4"
      required
      placeholder="Tell us about your project..."
      class="w-full px-4 py-3 bg-transparent border-b-2 border-muted focus:border-secondary outline-none transition-colors duration-300 placeholder:text-muted/50 resize-none"
    ></textarea>
  </div>

  <!-- Submit Button -->
  <Button variant="solid" size="md" class="w-full md:w-auto px-12" id="submit-btn">
    <span id="btn-text">Submit</span>
    <span id="btn-loader" class="hidden">
      <svg class="animate-spin h-5 w-5 inline-block" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
        <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
        <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
      </svg>
      Sending...
    </span>
  </Button>
</form>

<script>
  const form = document.getElementById('contact-form') as HTMLFormElement;
  const submitBtn = document.getElementById('submit-btn') as HTMLButtonElement;
  const btnText = document.getElementById('btn-text');
  const btnLoader = document.getElementById('btn-loader');
  const formMessage = document.getElementById('form-message');

  if (form) {
    form.addEventListener('submit', async (e) => {
      e.preventDefault();
      
      // Clear previous messages
      if (formMessage) {
        formMessage.classList.add('hidden');
        formMessage.innerHTML = '';
      }

      // Show loading state
      if (submitBtn && btnText && btnLoader) {
        submitBtn.disabled = true;
        btnText.classList.add('hidden');
        btnLoader.classList.remove('hidden');
      }

      // Simulate sending delay (demo only)
      await new Promise(resolve => setTimeout(resolve, 1500));

      // Show success message (demo only - no actual email sent)
      if (formMessage) {
        formMessage.classList.remove('hidden');
        formMessage.className = 'p-4 bg-green-100 border-2 border-green-500 rounded-xl text-green-800';
        formMessage.innerHTML = '<p class="font-semibold">‚úì Demo submission successful! (No email was actually sent)</p>';
      }
      
      // Reset form
      form.reset();
      
      // Scroll to success message
      formMessage?.scrollIntoView({ behavior: 'smooth', block: 'center' });

      // Restore button
      if (submitBtn && btnText && btnLoader) {
        submitBtn.disabled = false;
        btnText.classList.remove('hidden');
        btnLoader.classList.add('hidden');
      }
    });
  }
</script>
