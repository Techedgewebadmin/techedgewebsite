---
import Button from "@/components/ui/buttons/Button.astro";
import Heading from "@/components/common/Heading.astro";
import ProjectCard from "@/components/ui/cards/ProjectCard.astro";
import type { CollectionEntry } from "astro:content";
import { t } from "@/lib/utils";

interface Props {
  projects?: CollectionEntry<"projects">[];
}

const { projects = [] } = Astro.props;

// Validation: If there are no projects, do not render anything.
if (!projects || projects.length === 0) {
  console.error("ProjectsSection: No projects provided");
}

---

<section class="py-16 md:py-20">
  <div class="container mx-auto px-4 max-w-7xl">
    <!-- Projects Grid -->
    <div class="grid grid-cols-1 lg:grid-cols-5 gap-6 lg:gap-8 items-end">
      <!-- Div1: Header Section (3 cols x 2 rows) -->
      <div
        class="lg:col-span-3 lg:row-span-2 flex flex-col justify-center max-w-2xl"
      >
        <Heading heading={t('ourprojects.heading')} />
        <h2
          class="text-3xl md:text-4xl xl:text-6xl font-anton uppercase leading-none tracking-tight"
        >
          {t('ourprojects.title')}
        </h2>
        <p class="text-lg mt-4 font-sans max-w-xl text-muted">
          {t('ourprojects.description')}
        </p>
        <div class="mt-8">
          <Button href="/projects" variant="solid" size="md">
            {t('ourprojects.btn')}
          </Button>
        </div>
      </div>

      {
        projects.slice(0, 3).map((project, index) => {
          let gridClass = "";
          let size: "large" | "small" = "small";

          if (index === 0) {
            // Featured Project: Bottom Left
            gridClass =
              "lg:col-span-3 lg:row-span-4 lg:col-start-1 lg:row-start-3";
            size = "large";
          } else if (index === 1) {
            // Side Project 1: Top Right
            gridClass =
              "lg:col-span-2 lg:row-span-3 lg:col-start-4 lg:row-start-1";
          } else if (index === 2) {
            // Side Project 2: Bottom Right
            gridClass =
              "lg:col-span-2 lg:row-span-3 lg:col-start-4 lg:row-start-4";
          }

          return (
            <div class={gridClass}>
              <ProjectCard
                project={project}
                size={size}
                className="h-full"
              />
            </div>
          );
        })
      }
    </div>
  </div>
</section>
